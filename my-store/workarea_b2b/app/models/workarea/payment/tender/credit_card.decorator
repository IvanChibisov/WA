module Workarea
  decorate Payment::Tender::CreditCard, with: :b2b do
    decorated do
      delegate :account_profile, to: :payment, allow_nil: true
    end

    def saved_card
      return unless saved?
      @account_saved_card ||=
        super || account_profile.credit_cards.find(saved_card_id)
    rescue
      @account_saved_card = nil
    end
  end
end
